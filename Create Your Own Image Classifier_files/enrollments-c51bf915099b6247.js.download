(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4554],{53239:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/enrollments",function(){return r(19823)}])},6064:function(e,n,r){"use strict";r.d(n,{C:function(){return o}});var t=r(67294),o=function(e){var n=(0,t.useState)(e),r=n[0],o=n[1],a=(0,t.useRef)();return(0,t.useEffect)((function(){"function"===typeof a.current&&(a.current(r),a.current=void 0)}),[r]),[r,function(e,n){a.current=n,o(e)}]}},19823:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return At}});var t=r(34051),o=r.n(t),a=r(85893),s=r(67294),i=r(2962),c=r(26793),l=r(50514),u=r(44473),d=r(40556),p=r(83271),f=r(98826),m=r(14293),h=r.n(m),v=r(62255),g=r(86664),x=r(34454),y=r(5515),b=r(42937),_=r(96486),j=r.n(_),C=r(51179),w=r(63686),E=r(89941);function S(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function O(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){S(a,t,o,s,i,"next",e)}function i(e){S(a,t,o,s,i,"throw",e)}s(void 0)}))}}function A(e,n){return k.apply(this,arguments)}function k(){return(k=O(o().mark((function e(n,r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,w.Ps)("".concat((0,C.H)("/api/classroom-content"),"/v1/graphql"),'\n      query LearnWeb_isDiscountEligible{\n        isDiscountEligible(subscription_urn:"'.concat(n,'", declinedOffer: ').concat(r,"){\n          is_eligible\n          discount_amount_display\n          subtotal_amount_display\n          refunded_amount_display\n        }\n      }"));case 3:return t=e.sent,e.abrupt("return",{is_eligible:t.data.isDiscountEligible.is_eligible,discount_amount_display:t.data.isDiscountEligible.discount_amount_display,subtotal_amount_display:t.data.isDiscountEligible.subtotal_amount_display,refunded_amount_display:t.data.isDiscountEligible.refunded_amount_display});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{is_eligible:!1,discount_amount_display:"",subtotal_amount_display:"",refunded_amount_display:""});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function P(e,n){return R.apply(this,arguments)}function R(){return(R=O(o().mark((function e(n,r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,w.Ps)("".concat((0,C.H)("/api/classroom-content"),"/v1/graphql"),'\n      mutation LearnWeb_applySubscriptionDiscount{\n        applySubscriptionDiscount(subscription_urn:"'.concat(n,'", declinedOffer:').concat(r,"){\n          success\n        }\n      }"));case 3:return t=e.sent,e.abrupt("return",{success:t.data.applySubscriptionDiscount.success,message:null});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{success:!1,message:e.t0.errors[0].message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function D(e,n,r){return I.apply(this,arguments)}function I(){return(I=O(o().mark((function e(n,r,t){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat((0,C.H)("/api/braavos"),"/subscriptions/").concat(n,"/switch_nanodegree?nanodegree_key=").concat(r),e.prev=1,e.next=4,(0,w.v_)(a,{});case 4:return e.abrupt("return",{success:!0,message:null});case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",{success:!1,message:null!==(s=e.t0.responseJSON.errors[0])&&void 0!==s?s:t("services.errorSwitchingNanodegrees")});case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function T(e,n,r){return F.apply(this,arguments)}function F(){return(F=O(o().mark((function e(n,r,t){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,w.U2)("".concat((0,C.H)("/api/braavos"),"/subscriptions/").concat(n,"/switch_nanodegree"),{},{nanodegree_key:r});case 3:return e.abrupt("return",{success:!0});case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",{success:!1,message:null!==(s=null===(a=e.t0.data.errors)||void 0===a?void 0:a[0])&&void 0!==s?s:t("services.errorCheckingEligibility")});case 11:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function N(e){return L.apply(this,arguments)}function L(){return(L=O(o().mark((function e(n){var r,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,E.sq)(),t={card_token:n,provider:"stripe"},e.prev=2,e.next=5,(0,w.v_)("".concat((0,C.H)("/api/braavos"),"/users/").concat(r,"/payment_methods"),t);case 5:return e.abrupt("return",{success:!0,message:"payment_method.saved_credit_card"});case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",{success:!1,message:e.t0.responseJSON.errors[0]});case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function U(e){return M.apply(this,arguments)}function M(){return(M=O(o().mark((function e(n){var r,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat((0,C.H)("/api/braavos"),"/payment_methods/").concat(n),e.prev=1,e.next=4,(0,w.Jl)(r,{});case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),t=j().get(e.t0.responseJSON,"errors[0]",e.t0.statusText),e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function z(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function H(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){z(a,t,o,s,i,"next",e)}function i(e){z(a,t,o,s,i,"throw",e)}s(void 0)}))}}var q,$=function(){var e=H(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(n);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),X=r(54465),K=function(){return q||(q=(0,X.J)((0,C.H)("pk_live_4ubp5nwZfwTgHyToeeygtLYh"))),q},V=r(32579),G=function(e){var n=e.onAddClick,r=(0,c.$)().t;return(0,a.jsxs)(l.kC,{direction:"column",p:8,align:"center",justify:"center",children:[(0,a.jsx)(V.Ee,{src:"/assets/images/icons/light-gear-money.svg",alt:"",w:24,h:24}),(0,a.jsx)(l.xv,{textAlign:"center",mb:6,children:r("settings.enrollments.addPaymentMethodMessage")}),(0,a.jsx)(v.zx,{onClick:n,w:"max-content",children:r("settings.enrollments.addPaymentMethod")})]})},B=r(4821),Q=r(87536),W=r(40967),Y=r(97522),Z=r(37314),J=r(92710),ee=r(58013),ne=r(75586),re={iconStyle:"solid",hidePostalCode:!0,style:{base:{iconColor:"#02b3e4",fontFamily:"Open Sans, sans-serif",fontSize:"16px",fontSmoothing:"antialiased"},invalid:{iconColor:"#f04546",color:"#f04546"}}},te=function(e){var n=e.errorMessage,r=e.onChange,t=(0,c.$)().t;return(0,a.jsxs)(W.NI,{isInvalid:Boolean(n),children:[(0,a.jsx)(W.lX,{mb:2,children:t("settings.enrollments.cardData")}),(0,a.jsx)(l.kC,{h:12,p:"0.625rem 1rem",border:"1px",borderColor:"gray.500",borderRadius:"sm",alignItems:"center",justifyContent:"center",fontSize:"md",children:(0,a.jsx)(g.CardElement,{id:"cardNumber",options:re,onChange:r})}),n&&(0,a.jsx)(J.I,{message:n})]})};function oe(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function ae(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){oe(e,n,r[n])}))}return e}var se=function(e){var n,r,t=e.isOpen,i=e.defaultCountry,u=e.onClose,d=(0,c.$)().t,p=function(e){var n=e.onSubmitSuccess,r=(0,c.$)().t,t=(0,g.useStripe)(),a=(0,g.useElements)(),i=(0,x.V)(),l=!t,u=(0,s.useState)(void 0),d=u[0],p=u[1],f=(0,s.useState)(""),m=f[0],h=f[1],v=(0,s.useState)(!1),y=v[0],b=v[1],_=function(){var e=H(o().mark((function e(s){var c,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&a&&!d){e.next=2;break}return e.abrupt("return");case 2:if(b(!0),!(c=a.getElement("card"))){e.next=9;break}return e.next=8,t.createToken(c,{address_country:s.country.value,address_zip:s.postalCode,name:s.name});case 8:l=e.sent;case 9:if(!(null===l||void 0===l?void 0:l.error)){e.next=13;break}return b(!1),p(l.error),e.abrupt("return");case 13:if(u=(null===l||void 0===l?void 0:l.token)&&l.token.id){e.next=18;break}return b(!1),h("An error occurred while processing the payment. Please try again later."),e.abrupt("return");case 18:return e.prev=18,e.next=21,N(u);case 21:i({variant:"success",message:r("settings.enrollments.paymentSuccessfullyUpdated")}),e.next=28;break;case 24:return e.prev=24,e.t0=e.catch(18),i({variant:"error",message:r("settings.enrollments.paymentNotUpdated")}),e.abrupt("return");case 28:return e.prev=28,b(!1),e.finish(28);case 31:b(!1),n();case 33:case"end":return e.stop()}}),e,null,[[18,24,28,31]])})));return function(n){return e.apply(this,arguments)}}();return{submitPayment:_,onCardElementChange:function(e){p(e.error)},stripeErrorMessage:null===d||void 0===d?void 0:d.message,apiErrorMessage:m,isSaveEnabled:!l&&!y}}({onSubmitSuccess:u}),f=p.stripeErrorMessage,m=p.isSaveEnabled,h=p.submitPayment,y=p.onCardElementChange,b=(0,Q.cI)({defaultValues:{country:null!==(n=ne.O$.find((function(e){return e.value===i})))&&void 0!==n?n:{value:"US",label:"United States"},name:"",postalCode:""}}),_=b.register,j=b.handleSubmit,C=b.control,w=b.watch,E=b.formState,S=E.errors,O=E.isSubmitting,A=w("country"),k=(0,s.useMemo)((function(){return null!==(r=ne.QJ.get(A.value))&&void 0!==r?r:ne.uR}),[A]),P=j((function(e){return h(e)}));return(0,a.jsx)(ee.u,{isOpen:t,onClose:u,title:d("settings.enrollments.billingInformation"),footerStyles:{gap:4},footer:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.zx,{variant:"outline",onClick:u,children:d("common.cancel")}),(0,a.jsx)(v.zx,{type:"submit",form:"payment-method",variant:"solid",disabled:O||!m,children:d("common.save")})]}),children:(0,a.jsx)("form",{id:"payment-method",onSubmit:P,children:(0,a.jsxs)(l.Kq,{spacing:4,children:[(0,a.jsxs)(W.NI,{isInvalid:Boolean(S.name),children:[(0,a.jsx)(W.lX,{mb:2,children:d("common.name")}),(0,a.jsx)(Y.II,ae({type:"text"},_("name",{required:!0}),{autoFocus:!0})),(0,a.jsx)(J.I,{message:d("settings.enrollments.nameRequired")})]}),(0,a.jsx)(te,{onChange:y,errorMessage:f}),(0,a.jsxs)(W.NI,{isInvalid:Boolean(S.country),children:[(0,a.jsx)(W.lX,{mb:2,children:d("common.country")}),(0,a.jsx)(Q.Qr,{render:function(e){var n=e.field;return(0,a.jsx)(B.Z,ae({chakraStyles:(0,Z.AP)(),options:ne.O$},n))},name:"country",control:C}),(0,a.jsx)(J.I,{message:d("settings.enrollments.countryRequired")})]}),(0,a.jsxs)(W.NI,{isInvalid:Boolean(S.postalCode),children:[(0,a.jsx)(W.lX,{mb:2,children:d("settings.enrollments.postalCode")}),(0,a.jsx)(Y.II,ae({type:"text"},_("postalCode",{required:!0,pattern:k}))),(0,a.jsx)(J.I,{message:d("settings.enrollments.postalCodeInvalid")})]})]})})})},ie=new Map;ie.set("american-express","/assets/credit-card-icons/amex.svg"),ie.set("amex","/assets/credit-card-icons/amex.svg"),ie.set("diners-club","/assets/credit-card-icons/diners-club.svg"),ie.set("discover","/assets/credit-card-icons/discover.svg"),ie.set("jcb","/assets/credit-card-icons/jcb.svg"),ie.set("mastercard","/assets/credit-card-icons/master.svg"),ie.set("master-card","/assets/credit-card-icons/master.svg"),ie.set("union-pay","/assets/credit-card-icons/union-pay.svg"),ie.set("visa","/assets/credit-card-icons/visa.svg"),ie.set("generic","/assets/credit-card-icons/generic-credit-card.svg");var ce=function(e){var n=e.billingMethod,r=(0,c.$)().t,t=n.creditCard,o=t.brand,s=void 0===o?"generic":o,i=t.last4,u=t.expMonth,d=t.expYear;return(0,a.jsx)(l.xu,{p:8,children:(0,a.jsxs)(l.kC,{align:"center",bgColor:"white",children:[(0,a.jsx)(V.Ee,{src:ie.get(s.toLowerCase()),alt:s,h:12,me:8}),(0,a.jsxs)("span",{children:[(0,a.jsxs)(l.xv,{children:["**** **** **** ",i]}),(0,a.jsx)(l.xv,{children:r("common.expires")+" ".concat(u,"/").concat(d.slice(2))})]})]})})};function le(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}var ue=function(e){var n=e.isCardAddEnabled,r=(0,c.$)().t,t=(0,x.V)(),i=(0,b.D)().userLocation,d=(0,y.I)(),p=d.data,f=d.isFetching,m=null===p||void 0===p?void 0:p.billingInfo.billingMethods[0],_=(0,s.useState)(!1),j=_[0],C=_[1],w=(0,s.useState)(!1),E=w[0],S=w[1],O=(0,s.useState)(!0),A=O[0],k=O[1],P=!1,R="";(0,s.useEffect)((function(){"CN"===(null===i||void 0===i?void 0:i.countryCode)?k(!1):K().then((function(){return k(!1)}))}),[null===i||void 0===i?void 0:i.countryCode]);var D=(0,s.useCallback)((function(){S(!0),t({variant:"success",message:r("settings.enrollments.successfullyRemovedPaymentMethod")})}),[t,r]),I=function(){var e,n=(e=o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m){e.next=4;break}return e.next=3,$(m.urn);case 3:D();case 4:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){le(a,t,o,s,i,"next",e)}function i(e){le(a,t,o,s,i,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}();if("CN"===(null===i||void 0===i?void 0:i.countryCode))return(0,a.jsx)("div",{children:(0,a.jsx)("section",{})});if(A||f)return(0,a.jsx)("section",{children:(0,a.jsx)(u.$,{label:r("common.loading")})});return E||h()(m)?(0,a.jsx)(l.xu,{borderRadius:"base",border:"solid 1px",borderColor:"gray.300",children:(0,a.jsx)(G,{onAddClick:function(){return C(!0)}})}):(0,a.jsx)(l.xu,{borderRadius:"base",border:"solid 1px",borderColor:"gray.300",children:!1===j?(0,a.jsxs)("div",{children:[function(){var e=m&&m.removable,t=n&&m;return(0,a.jsxs)(l.kC,{as:"header",bgColor:"gray.100",px:8,py:4,align:"center",justify:"space-between",borderTopRadius:"base",children:[(0,a.jsx)(l.X6,{size:"h5",as:"h3",children:r("settings.enrollments.billingInformation")}),(0,a.jsxs)(l.kC,{gap:4,children:[e&&!E&&(0,a.jsx)(v.zx,{onClick:I,variant:"solid",children:r("common.remove")}),t&&!E&&(0,a.jsx)(v.zx,{onClick:function(){return C(!0)},variant:"outline",children:r("common.edit")})]})]})}(),m?(0,a.jsxs)("div",{children:[(0,a.jsx)(ce,{billingMethod:m}),P?(0,a.jsx)("span",{children:R}):null]}):null]}):(0,a.jsx)(g.Elements,{stripe:K(),children:(0,a.jsx)(se,{isOpen:j,onClose:function(){return C(!1)},defaultCountry:null===i||void 0===i?void 0:i.countryCode})})})},de=r(92098),pe=r(42642),fe=r(24435),me=r(22298);function he(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}var ve,ge=function(e){var n,r=e.accessDate,t=e.enrollment,i=e.cancelEnrollment,u=(0,s.useState)(!1),d=u[0],p=u[1],f=(0,c.$)().t,m=t.program.title,h=(0,s.useCallback)((n=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0),p(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})),function(){var e=this,r=arguments;return new Promise((function(t,o){var a=n.apply(e,r);function s(e){he(a,t,o,s,i,"next",e)}function i(e){he(a,t,o,s,i,"throw",e)}s(void 0)}))}),[i,p]),g=(0,s.useCallback)((function(){p(!1);var e={course_id:t.program.id,category:"Remove Course Attempt",label:"Remove Course Attempt - Dismissed",is_graduated:t.isGraduated,title:m};(0,fe.j)("Remove Course Modal Dismissed",e)}),[m,t]);return(0,a.jsx)("li",{children:(0,a.jsxs)(l.kC,{align:"center",justify:"space-between",children:[(0,a.jsxs)(l.Kq,{spacing:1,children:[(0,a.jsx)(l.xv,{fontWeight:"bold",children:m}),(0,a.jsx)(l.xv,{children:null!==r&&f("settings.enrollments.accessed",{accessDate:r})})]}),(0,a.jsxs)(v.zx,{variant:"ghost",size:"md-round",colorScheme:"red","aria-label":f("settings.enrollments.unenroll"),onClick:function(){return p(!0)},children:[(0,a.jsx)(pe.XHJ,{w:6,h:6,mr:1}),f("common.remove")]}),(0,a.jsx)(me.h,{isOpen:d,title:f("settings.enrollments.removeCourse"),cancelText:f("settings.enrollments.unenroll"),onClose:g,onCancelClick:h,children:(0,a.jsx)(l.xv,{color:"gray.700",textAlign:"center",children:f("settings.enrollments.confirmUnenroll",{courseName:m})})})]})})},xe=function(e){var n=e.cancelEnrollment,r=e.enrollments,t=(0,c.$)().t,o=(0,s.useMemo)((function(){return Object.fromEntries(r.map((function(e){var r=e.program;return[r.key,function(){return n(r.key)}]})))}),[n,r]);return r.length?(0,a.jsx)(l.Kq,{as:"ul",spacing:4,children:r.map((function(e){var n,r=null===e.timestamps.lastViewedAt?null:(0,de.Fc)(e.timestamps.lastViewedAt).format("ll");return(0,a.jsx)(ge,{accessDate:r,enrollment:e,cancelEnrollment:o[null!==(n=e.program.key)&&void 0!==n?n:""]},e.program.key)}))}):(0,a.jsx)(l.xv,{children:t("settings.enrollments.notEnrolled")})},ye=r(59251),be=r(9562),_e=function(){var e=(0,c.$)().t;return(0,a.jsxs)(l.Kq,{spacing:2,children:[(0,a.jsx)(l.X6,{size:"h2",as:"h2",children:e("settings.enrollments.needHelp")}),(0,a.jsx)(l.xv,{children:(0,a.jsxs)(ye.c,{i18nKey:"settings.enrollments.helpAndFaqs",children:["_",(0,a.jsx)(be.P,{href:"https://udacity.zendesk.com/hc/en-us",target:"_blank",rel:"noreferrer",children:"_"})]})})]})},je=r(97375),Ce=r(8370),we=r(27361),Ee=r.n(we),Se=r(41609),Oe=r.n(Se),Ae=r(89734),ke=r.n(Ae),Pe="Cancel CTA Clicked",Re="Cancel Request Initiated",De="Cancel Request Discount",Ie="Cancel Modal Closed",Te="Chat_Only",Fe="Self_Serve",Ne="Self_Serve_Discount";!function(e){e.CALL_CLICKED="Call_CTA_Clicked",e.CHAT_CLICKED="Chat_CTA_Clicked",e.EMAIL_CLICKED="Email_CTA_Clicked",e.SELF_SERVE="Self_Serve_Cancel_From_Survey",e.SELF_SERVE_DISCOUNT_DISQUALIFIED="Self_Serve_Cancel_From_Discount",e.SELF_SERVE_DISCOUNT_PRESENTED="Self_Serve_Discount_CTA_Presented",e.SELF_SERVE_DISCOUNT_ABANDONED="Self_Serve_Discount_CTA_Abandoned",e.SELF_SERVE_DISCOUNT_ACCEPTED="Self_Serve_Discount_CTA_Accepted",e.SELF_SERVE_DISCOUNT_APPLIED="Self_Serve_Discount_CTA_Applied",e.SELF_SERVE_DISCOUNT_SEARCH_CATALOG="Self_Serve_Discount_CTA_Search_Catalog",e.SELF_SERVE_DISCOUNT_APPLY_FAILED="Self_Serve_Discount_CTA_Apply_Failed"}(ve||(ve={}));var Le={call:"cancel_call_flow",chat:"cancel_chat_flow",email:"cancel_email_flow",call_only_override:"cancel_call_flow_only_override",self_serve_with_discount:"cancel_survey_discount_flow",self_serve_with_discount_low_grc:"cancel_survey_discount_flow_low_grc"},Ue="country_code",Me="region",ze="rp",He="test_user",qe={SELF_SERVE_DISCOUNT:{name:"self-serve-discount",value:Ne,requires:["discount"]},CHAT:{name:"chat",value:Te,requires:["chat"]},SELF_SERVE:{name:"self-serve",value:Fe,requires:[]},LAST_RESORT:{name:"self-serve-discount",value:Ne,requires:[]}},$e="Initial Questions Page",Xe="Program Switch Page",Ke="Program Switch Success Page",Ve="Cannot Switch Programs Page",Ge="Discount Offer Page",Be="Discount Offer Error Page",Qe="Subscription Cancelled Page",We=r(50194);function Ye(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function Ze(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Je(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,o,a=[],s=!0,i=!1;try{for(r=r.call(e);!(s=(t=r.next()).done)&&(a.push(t.value),!n||a.length!==n);s=!0);}catch(c){i=!0,o=c}finally{try{s||null==r.return||r.return()}finally{if(i)throw o}}return a}}(e,n)||en(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(e,n){if(e){if("string"===typeof e)return Ye(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ye(e,n):void 0}}function nn(e,n,r,t){var o=function(e){var n=Object.values(qe).find((function(n){return n.name===e}));return void 0===n?(console.error("Unrecognized support type: ".concat(e)),e):n.value}(r);return(0,We.a)(n,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){Ze(e,n,r[n])}))}return e}({},e,t,{value:o,category:o})).catch((function(e){console.error(e)}))}function rn(e){return Object.entries(Le).reduce((function(n,r){return n[Je(r,1)[0]]=e,n}),{})}var tn=function(e){var n=e.payment_history;return!Oe()(n)&&!!n.find((function(e){var n,r,t=e.total_amount.minor;return("paid"===(null===(n=e.charge)||void 0===n?void 0:n.status)||"partially_refunded"===(null===(r=e.charge)||void 0===r?void 0:r.status))&&t>0}))};function on(e,n,r,t,o){var a,s,i=t.score,c=t.type,l=t.day,u=t.fullModel;return{auto_renew_eligible:null===(a=r.next_payment)||void 0===a?void 0:a.can_auto_renew,campaign_name:r.campaign_name,cancel_flow_version:8,country:e,region:n,has_intercom:!1,eligible_for_refund:r.can_refund,enrolled_at:r.created_at,first_payment_length:r.payment_plan.upfront_interval_count,has_paid:tn(r),nd_key:r.purchased_products[0].nanodegree_key,nd_title:r.purchased_product_description,payment_method:null===(s=r.payment_method)||void 0===s?void 0:s.processor,payment_plan_type:r.payment_plan.type,purchase_urn:r.urn,optimizely_chat_enabled:o.chat,optimizely_self_serve_discount_enabled:o.self_serve_with_discount,optimizely_self_serve_discount_low_grc_enabled:o.self_serve_with_discount_low_grc,grc_model:u,grc_score:i,grc_score_type:c,grc_model_day:l}}var an,sn=function(){var e=(0,c.$)().t;return(0,a.jsxs)(l.kC,{direction:"column",align:"center",p:8,rounded:"base",border:"1px",borderColor:"gray.300",bgColor:"white",children:[(0,a.jsx)(V.Ee,{width:32,h:32,src:"/assets/images/icons/light-alert-green.svg",alt:""}),(0,a.jsx)(l.X6,{size:"h2",textAlign:"center",mb:6,children:e("settings.enrollments.yetToEnroll")}),(0,a.jsx)(v.zx,{as:l.rU,href:"https://www.udacity.com/nanodegree",isExternal:!0,textDecor:"none",_visited:{color:"white"},_hover:{textDecor:"none",color:"white"},children:e("common.explorePrograms")})]})};!function(e){e.FLEX_SUBSCRIPTION="flex_subscription",e.UPFRONT_RECURRING="upfront_recurring",e.RECURRING="recurring"}(an||(an={}));an.UPFRONT_RECURRING,an.RECURRING;var cn=r(31955),ln=r(4218),un=r(9493),dn=r(72655),pn=r(10555),fn=function(e,n){var r={score:n,type:null,day:null,fullModel:null};if(null===e)return r;var t=e.find((function(e){return"GRC"===e.model}));return t&&t.values?t.values.day_7?{score:t.values.day_7.r,type:"r",day:7,fullModel:t}:t.values.day_14?{score:t.values.day_14.r,type:"r",day:14,fullModel:t}:t.values.day_21?{score:t.values.day_21.r,day:21,type:"r",fullModel:t}:r:r};function mn(){var e=(0,s.useRef)(!1);return(0,s.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),(0,s.useCallback)((function(){return e.current}),[])}var hn=r(27373),vn=r(15199),gn=r(7403),xn=r(42012),yn=r(63158),bn=r(41664),_n=r(93162);function jn(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function Cn(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){jn(a,t,o,s,i,"next",e)}function i(e){jn(a,t,o,s,i,"throw",e)}s(void 0)}))}}function wn(e){return En.apply(this,arguments)}function En(){return(En=Cn(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,w.v_)("".concat((0,C.H)("/api/printer"),"/v2/invoice"),n,{},!0);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sn(e,n){return e.includes(".html: no such file or directory")?n("services.errorCreatingInvoiceLanguage"):e.includes("jwt missing")?n("services.errorCreatingInvoiceAuth"):n("services.errorCreatingInvoice")}function On(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function An(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function kn(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var Pn=function(e,n){if("ADDRESS_INPUT_UPDATE"===n.type){var r=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){An(e,n,r[n])}))}return e}({},e,An({},n.input,n.value));return r}return e},Rn=function(e){var n=e.createErrorAlert,r=e.onClose,t=e.open,i=e.payment,u=e.paymentPlan,d=e.productInfo,p=(0,c.$)(),f=p.t,m=p.i18n,h=(0,s.useReducer)(Pn,{fullName:"",address1:"",address2:"",company:""}),g=h[0],x=h[1],y=m.language.toLowerCase(),b="en"===y?"en-us":y,j=function(e){var n=e.target.name,r=e.target.value;x({type:"ADDRESS_INPUT_UPDATE",input:n,value:r})},C=function(){var e,t=(e=o().mark((function e(){var t,a,s,c,l,p,m,h,v,g,x,y,b,_,j;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.cohort_id,a=d.nanodegree_key,s=d.term_id,c=w(i,u),l=(0,E.sq)(),c.template,p=c.invoice_id,m=kn(c,["template","invoice_id"]),h=i.urn,v=i.total_amount.display,e.prev=5,e.next=8,wn(c);case 8:g=e.sent,x="paid"===i.status,y=x?"Payment receipt ".concat(p,".pdf"):"Invoice ".concat(p,".pdf"),b=new File([g],y,{type:"application/octet-stream"}),(0,_n.saveAs)(b,b.name),(0,fe.j)("Receipt Downloaded",{invoiceUrn:h,payment_plan_type:S(u),receipt_price:v,user_id:l,cohort_id:t,program_key:a,term_id:s,restParams:m}),r(),e.next=24;break;case 17:e.prev=17,e.t0=e.catch(5),_=e.t0.error.message,j=Sn(_,f),console.error(e.t0),n(j),r();case 24:case"end":return e.stop()}}),e,null,[[5,17]])})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){On(a,t,o,s,i,"next",e)}function i(e){On(a,t,o,s,i,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}(),w=function(e,n){var r=e.urn.split(":").pop(),t=e.line_items;return{address_1:g.address1,address_2:g.address2,company:g.company,invoice_id:r,locale:b,name:g.fullName,template:"nd-term-invoice",line_items:t,type:S(n)}},S=function(e){switch(e.type){case an.RECURRING:return"Month";case an.UPFRONT_RECURRING:return"".concat(e.upfront_interval_count," Month Bundle");default:return"Seat"}};return"en-us"===b||"en"===b?(0,a.jsx)(ee.u,{isOpen:t,onClose:r,title:f("settings.enrollments.downloadReceipt"),children:(0,a.jsxs)(l.Kq,{spacing:4,children:[(0,a.jsx)(l.xv,{children:f("settings.enrollments.addToDownloadReceipt")}),(0,a.jsxs)(W.NI,{isRequired:!0,children:[(0,a.jsx)(W.lX,{htmlFor:"fullName",mb:2,children:f("settings.enrollments.fullName")}),(0,a.jsx)(Y.II,{id:"fullName",name:"fullName",required:!0,onChange:j,value:g.fullName})]}),(0,a.jsxs)(W.NI,{children:[(0,a.jsx)(W.lX,{htmlFor:"company",mb:2,children:f("common.company")}),(0,a.jsx)(Y.II,{id:"company",name:"company",onChange:j,value:g.company})]}),(0,a.jsxs)(W.NI,{children:[(0,a.jsx)(W.lX,{htmlFor:"address1",mb:2,children:f("settings.enrollments.address1")}),(0,a.jsx)(Y.II,{id:"address1",name:"address1",onChange:j,value:g.address1})]}),(0,a.jsxs)(W.NI,{children:[(0,a.jsx)(W.lX,{htmlFor:"address2",mb:2,children:f("settings.enrollments.address2")}),(0,a.jsx)(Y.II,{id:"address2",name:"address2",onChange:j,value:g.address2})]}),(0,a.jsx)(l.kC,{justify:"center",p:8,children:(0,a.jsx)(v.zx,{disabled:(0,_.isEmpty)(g.fullName),onClick:C,variant:"solid",children:f("settings.enrollments.downloadReceipt")})})]})}):(0,a.jsx)(ee.u,{isOpen:t,onClose:r,title:f("settings.enrollments.invoiceUnavailable"),children:(0,a.jsx)(l.xv,{align:"center",children:(0,a.jsxs)(ye.c,{i18nKey:"settings.enrollments.languageNotSupported",children:["_",(0,a.jsx)(bn.default,{href:"/settings/language-preference",children:"_"}),"_"]})})})};function Dn(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function In(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Tn(e){return function(e){if(Array.isArray(e))return Dn(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return Dn(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dn(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Fn,Nn,Ln=function(e){var n=e.createErrorAlert,r=e.nextPayment,t=e.payments,o=e.productInfo,i=e.paymentPlan,u=e.isFlexSubscription,d=(0,s.useState)(""),p=d[0],f=d[1],m=(0,c.$)().t,h=function(){return t.filter((function(e){var n=e.status;return!hn.eb.includes(n)}))},g=function(){f("")},x=function(e){var n=(0,de.aT)(e),r=m("gracePeriodWarning",{gracePeriod:n});return(0,a.jsx)(gn.u,{label:r,hasArrow:!0,variant:"light",children:(0,a.jsx)(pe.aNP,{color:"feedback.warning",w:6,h:6})})},y=function(e){var n=e.status,r=(0,pn.ef)(e,m);return n===hn.Q_.PAST_DUE||n===hn.Q_.FAILED?(0,a.jsxs)(l.kC,{align:"center",children:[(0,a.jsx)(l.xv,{children:r}),e.charge&&x(e.charge.charged_at)]}):(0,a.jsx)("div",{children:r})};return(0,a.jsxs)(xn.iA,{borderTop:"1px solid",borderColor:"gray.300",px:6,py:3,w:"full",children:[(0,a.jsx)(xn.hr,{borderBottom:"1px solid",borderColor:"gray.300",children:(0,a.jsxs)(xn.Tr,{children:[(0,a.jsx)(Un,{children:m("common.dueDate")}),(0,a.jsx)(Un,{children:m("common.status")}),(0,a.jsx)(Un,{textAlign:"end",children:m("common.amount")}),u&&(0,a.jsx)(Un,{children:m("settings.enrollments.billingPeriod")}),(0,a.jsx)(Un,{textAlign:"center",children:m("common.receipt")})]})}),(0,a.jsx)(xn.p3,{children:function(){if(r){var e=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){In(e,n,r[n])}))}return e}({},r,{status:(0,pn.HJ)(r)?"past_due":"due",charge:{charged_at:r.due_at}});return[e].concat(Tn(h()))}return h()}().map((function(e){return(0,a.jsxs)(xn.Tr,{children:[(0,a.jsx)(Mn,{children:e.charge&&(0,de.LA)(e.charge.charged_at)}),(0,a.jsx)(Mn,{children:y(e)}),(0,a.jsx)(Mn,{textAlign:"end",children:(0,pn.kb)(e)}),u&&(0,a.jsx)(Mn,{children:"".concat((0,de.LA)(e.period_start)," - ").concat((0,de.LA)(e.period_end))}),(0,a.jsxs)(Mn,{textAlign:"center",children:[(0,a.jsx)(v.hU,{variant:"ghost",size:"icon",isRound:!0,p:2,"aria-label":m("settings.enrollments.requestReceipt"),icon:(0,a.jsx)(pe._8t,{w:8,h:8}),onClick:function(){return n=e.urn,void f(n);var n}}),p===e.urn&&(0,a.jsx)(Rn,{createErrorAlert:n,payment:e,productInfo:o,open:!0,onClose:g,paymentPlan:i})]})]},e.urn)}))})]})},Un=(0,yn.m$)(xn.Th,{baseStyle:{color:"gray.900",textAlign:"start"}}),Mn=(0,yn.m$)(xn.Td,{baseStyle:{color:"gray.900",textAlign:"start",py:0,px:4}}),zn=r(91222),Hn=function(e){var n=e.label,r=e.date;return(0,a.jsxs)(l.Kq,{spacing:0,children:[(0,a.jsx)(l.xv,{size:"label",color:"gray.900",children:n}),(0,a.jsx)(l.X6,{size:"h3",as:"h3",children:(0,de._y)(r)})]})},qn=function(e){var n=e.programTitle,r=e.enrollmentDate,t=e.noUncancelReason,o=e.periodEndDate,s=e.status,i=(0,c.$)().t;return(0,a.jsxs)(l.kC,{direction:"column",gap:4,p:6,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.X6,{size:"h2",mb:1,children:n}),(0,a.jsx)(zn.Vp,{children:s})]}),(0,a.jsx)(Hn,{label:r.label,date:r.date}),(0,a.jsx)(l.xv,{children:t===hn.Q_.CA_OVER_LIMIT?(0,a.jsxs)(ye.c,{i18nKey:"settings.enrollments.priceCapReached",values:{periodEndDate:(0,de.LA)(o)},children:["_",(0,a.jsx)(l.rU,{href:"https://www.udacity.com/legal/en-us/california-residents",isExternal:!0,children:"_"})]}):i("settings.enrollments.cannotResumeSubscription")})]})},$n=r(73562),Xn=function(){var e=(0,c.$)().t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.X6,{size:"h3",as:"h3",textAlign:"center",mb:6,children:e("settings.enrollments.unexpectedError")}),(0,a.jsx)(l.xv,{align:"center",children:e("settings.enrollments.refreshTryAgain")})]})},Kn=r(48125),Vn=function(e){var n=e.handleCatalogOpen,r=e.handleModalClose,t=e.isRefundable,o=e.periodEndDate,s=(0,c.$)().t,i=t?s("settings.enrollments.successfullyCanceledRefundable"):s("settings.enrollments.successfullyCanceled",{periodEndDate:o});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.X6,{size:"h3",as:"h3",textAlign:"center",mb:6,children:s("settings.enrollments.cancellationConfirmed")}),(0,a.jsxs)(l.kC,{justify:"space-between",mb:5,gap:4,children:[(0,a.jsx)(l.kC,{justify:"center",w:"30%",mb:1,children:(0,a.jsx)("img",{src:"/assets/images/settings/cancel/nanodegree.svg",alt:"nanodegree"})}),(0,a.jsx)(l.xv,{mb:2,children:i})]}),(0,a.jsxs)(l.kC,{justify:"end",gap:4,children:[(0,a.jsx)(v.zx,{variant:"ghost",onClick:r,children:s("common.close")}),(0,a.jsx)(Kn.b,{href:(0,C.H)("https://www.udacity.com/courses/all"),variant:"solid",onClick:n,children:s("settings.enrollments.searchCatalog")})]})]})},Gn=r(6064);!function(e){e.TIME="time",e.QUALITY="quality",e.FIT="fit",e.COST="cost",e.SUPPORT="support",e.SWITCH="switch",e.PAUSE="pause",e.COVERED_MATERIAL="covered_material",e.OTHER="other"}(Fn||(Fn={})),function(e){e.CHAT_FLOW="chat-flow",e.DISCOUNT_FLOW="discount-flow",e.IMMEDIATE_CANCEL="immediate-cancel"}(Nn||(Nn={}));var Bn=function(e){var n=e.cancelInFlight,r=e.cancelReasonKey,t=e.declinedOffer,o=e.generateCouponInFlight,s=e.handleAbandonDiscountOffer,i=e.handleGenerateDiscountCoupon,d=e.isLoading,p=e.originalPrice,f=e.refundedDisplayAmount,m=e.subtotalDisplayAmount,h=(0,c.$)().t,g=h(t?"settings.enrollments.getToTheFinishLine":"settings.enrollments.helpKeepLearningOnTrack"),x=function(e){switch(e){case Fn.COST:return t?{heading:h("settings.enrollments.madeItThisFar"),image:(0,a.jsx)("img",{src:"/assets/images/settings/map-flag.png",alt:""})}:{heading:h("settings.enrollments.keepLearningForLess"),image:(0,a.jsx)("img",{src:"/assets/images/settings/cancel/clock.svg",alt:"tags"})};case Fn.OTHER:return{heading:"",image:null};case Fn.TIME:default:return{heading:h("settings.enrollments.needMoreTime"),image:(0,a.jsx)("img",{src:"/assets/images/settings/cancel/clock.svg",alt:"clock"})}}}(r),y=x.heading,b=x.image;return d?(0,a.jsx)(u.$,{label:h("common.loading")}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.X6,{size:"h3",as:"h3",textAlign:"center",mb:6,children:y}),(0,a.jsxs)(l.kC,{mb:5,children:[(0,a.jsx)(l.kC,{justify:"center",w:"30%",mb:1,children:b}),(0,a.jsxs)(l.xu,{children:[(0,a.jsx)(l.xv,{mb:4,children:g}),(0,a.jsxs)(l.xu,{my:"10px",children:[(0,a.jsx)(l.xv,{children:"".concat(h("settings.enrollments.nextPayment"),": ")}),(0,a.jsx)(l.X6,{size:"h2",color:t?"feedback.negative":"blue.500",children:m}),(0,a.jsx)(l.xv,{ms:4,children:"".concat(h("settings.enrollments.originalPrice"),": ")}),(0,a.jsx)(l.xv,{textDecor:"line-through",children:"$".concat((p.minor/100).toFixed(2))})]}),(0,a.jsx)(l.xv,{fontWeight:"semibold",lineHeight:1.8,children:(0,_.isEmpty)(f)?h("settings.enrollments.discountAllFuturePayments"):h("settings.enrollments.refundAmount",{refundedDisplayAmount:f})})]})]}),(0,a.jsxs)(l.kC,{justify:"end",gap:4,children:[!o&&!n&&(0,a.jsx)(v.zx,{variant:"ghost",onClick:s,children:h("settings.enrollments.continueCancellation")}),(0,a.jsx)(v.zx,{isDisabled:o,variant:"solid",onClick:i,children:h("settings.enrollments.acceptOffer")})]})]})},Qn=function(e){var n=e.cancelInFlight,r=e.handleCancel,t=e.handleModalClose,o=(0,c.$)().t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.X6,{size:"h3",as:"h3",textAlign:"center",mb:6,children:o("settings.enrollments.unableToGenerateCoupon")}),(0,a.jsxs)(l.xu,{mb:5,children:[(0,a.jsx)(l.kC,{justify:"center",w:"30%",mb:1,children:(0,a.jsx)("img",{src:"/assets/images/settings/cancel/nanodegree.svg",alt:"nanodegree"})}),(0,a.jsx)(l.xv,{mb:2,children:o("settings.enrollments.contactSupport")})]}),(0,a.jsxs)(l.kC,{justify:"end",gap:4,children:[!n&&(0,a.jsx)(v.zx,{variant:"ghost",onClick:r,children:o("settings.enrollments.continueCancellation")}),(0,a.jsx)(v.zx,{variant:"solid",onClick:t,children:o("common.back")})]})]})},Wn=r(60612);function Yn(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var Zn,Jn,er="radio",nr="text_area",rr="dropdown",tr=["AE","BD","BW","CM","DZ","EG","ET","GH","GT","IN","IQ","IR","JO","KE","KW","LV","MA","MZ","NG","NP","OM","PK","QA","RW","SA","SN","SO","TH","TN","TR","TZ","UG","UZ","YE","ZA","ZM","ZW"],or={default:(Zn={},Yn(Zn,Fn.COST,Nn.CHAT_FLOW),Yn(Zn,Fn.COVERED_MATERIAL,Nn.IMMEDIATE_CANCEL),Yn(Zn,Fn.TIME,Nn.CHAT_FLOW),Yn(Zn,Fn.PAUSE,Nn.CHAT_FLOW),Yn(Zn,Fn.QUALITY,Nn.IMMEDIATE_CANCEL),Yn(Zn,Fn.OTHER,Nn.DISCOUNT_FLOW),Zn),no_chat:(Jn={},Yn(Jn,Fn.COST,Nn.DISCOUNT_FLOW),Yn(Jn,Fn.COVERED_MATERIAL,Nn.IMMEDIATE_CANCEL),Yn(Jn,Fn.TIME,Nn.DISCOUNT_FLOW),Yn(Jn,Fn.PAUSE,Nn.DISCOUNT_FLOW),Yn(Jn,Fn.QUALITY,Nn.IMMEDIATE_CANCEL),Yn(Jn,Fn.OTHER,Nn.DISCOUNT_FLOW),Jn)},ar=function(e){var n=e.onDropdownChange,r=e.options,t=e.value,o=(0,c.$)().t;return(0,a.jsxs)(W.NI,{mb:"7rem",children:[(0,a.jsx)(W.lX,{children:o("settings.enrollments.unpauseSubscription")}),(0,a.jsx)(B.Z,{id:"unpauseDate",options:r,onChange:n,value:t,isRequired:!0,chakraStyles:(0,Z.AP)()})]})},sr=r(3370),ir=function(e){var n=e.hasOtherOption,r=e.otherText,t=e.onOtherTextChange,o=e.onReasonChange,i=e.reasons,u=e.value,d=(0,s.useRef)(),p=(0,c.$)().t;return(0,a.jsxs)(l.QI,{display:"flex",flexDir:"column",my:4,listStyleType:"none",ms:0,children:[i.map((function(e,n){return(0,a.jsx)(l.HC,{mb:4,children:(0,a.jsx)(sr.Y8,{id:"response-"+n,name:"responses-group",isChecked:u===e.raw,onChange:function(){o(e)},spacing:4,children:e.raw})},"response-"+n)})),n&&(0,a.jsxs)(l.HC,{display:"flex",alignItems:"center",whiteSpace:"nowrap",mb:4,children:[(0,a.jsx)(sr.Y8,{id:"responses-other",name:"responses-group",isChecked:"other"===u,onChange:function(){o({key:"other",raw:"other"})},spacing:4,children:"".concat(p("common.other"),":")}),(0,a.jsx)(Y.II,{type:"text",value:r,onChange:function(e){return t(e.target.value)},ref:d.current,height:"2.5rem",padding:"0.5rem",margin:"-0.75em 0 0 1em","aria-label":p("common.other")})]})]})},cr=function(e){var n=e.hasOtherOption,r=e.heading,t=e.ariaLabel,o=e.onDropdownChange,i=e.onOtherTextChange,c=e.onReasonChange,u=e.onTextChange,d=e.otherText,p=e.question,f=e.reasons,m=e.type,h=e.value,v=(0,s.useMemo)((function(){return f.map((function(e){return{value:e.raw,label:e.raw}}))}),[f]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.X6,{size:"h3",as:"h3",textAlign:"center",mb:6,children:r}),(0,a.jsx)(l.xv,{mb:2,children:p}),function(){switch(m){case rr:return(0,a.jsx)(ar,{ariaLabel:t,options:v,onDropdownChange:o,value:(e=h,v.find((function(n){return n.value===e})))});case er:return(0,a.jsx)(ir,{hasOtherOption:n,otherText:d,onOtherTextChange:i,onReasonChange:c,reasons:f,value:h});case nr:return(0,a.jsx)(Wn.g,{rows:3,"aria-label":"response",id:"response",onChange:function(e){u&&u(e.target.value)},value:h,mb:4});default:return null}var e}()]})},lr=r(47037),ur=r.n(lr),dr=r(69983),pr=r.n(dr),fr={};function mr(e,n,r){if(fr[n])return fr[n];var t=e.map((function(e){if(ur()(e))return{raw:e};var n=e.reason;return{key:e.key,raw:n}})),o=r&&r.noShuffle?t:pr()(t);return fr[n]=o,o}var hr=function(e){return mr([{key:Fn.COST,reason:e("settings.enrollments.cancelReasonCostShort")},{key:Fn.TIME,reason:e("settings.enrollments.cancelReasonTimeShort")},{key:Fn.SWITCH,reason:e("settings.enrollments.cancelReasonFitShort")},{key:Fn.COVERED_MATERIAL,reason:e("settings.enrollments.cancelReasonCoveredMaterial")},{key:Fn.QUALITY,reason:e("settings.enrollments.cancelReasonQuality")}],"main",{noShuffle:!1})};function vr(e,n,r){var t="default";return(function(e){return tr.includes(e)}(r)||function(e){return!e||!e.chat}(n))&&(t="no_chat"),or[t][e]||Nn.IMMEDIATE_CANCEL}function gr(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}var xr=function(e){var n=e.cancelInFlight,r=e.checkOfferEligibilityInFlight,t=e.isLoading,i=e.isRefundable,d=e.handleCancelReasonChange,p=e.handleContinueCancellation,f=e.handleModalClose,m=e.handleSwitchPrograms,h=e.periodEndDate,g=(0,c.$)().t,x=(0,s.useState)(""),y=x[0],b=x[1],_=(0,s.useState)(""),j=_[0],C=_[1],w=(0,s.useState)(""),E=w[0],S=w[1],O=function(){var e,n=(e=o().mark((function e(n){var r,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.raw,t=n.key,b(null!==t&&void 0!==t?t:""),S(r),d(null!==t&&void 0!==t?t:"",r);case 5:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){gr(a,t,o,s,i,"next",e)}function i(e){gr(a,t,o,s,i,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}(),A=i?g("settings.enrollments.cancelEffectiveImmediately"):g("settings.enrollments.cancelEffectiveEndDate",{periodEndDate:h}),k=""===y||"other"===y&&""===j;return r||t?(0,a.jsx)(u.$,{label:g("common.loading")}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cr,{heading:g("settings.enrollments.sorryToSeeYouGo"),question:A,reasons:hr(g),type:er,onReasonChange:O,value:E,hasOtherOption:!0,onOtherTextChange:function(e){C(e),S(Fn.OTHER),d(Fn.OTHER,e)},otherText:j}),(0,a.jsx)(l.kC,{justify:"end",gap:4,children:y===Fn.SWITCH?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.zx,{variant:"ghost",onClick:f,children:g("common.back")}),(0,a.jsx)(v.zx,{variant:"solid",onClick:m,children:g("common.switchPrograms")})]}):(0,a.jsxs)(a.Fragment,{children:[!n&&(0,a.jsx)(v.zx,{isDisabled:k,variant:"ghost",onClick:function(){return p(y,E)},children:g("settings.enrollments.continueCancellation")}),(0,a.jsx)(v.zx,{variant:"solid",onClick:f,children:g("common.back")})]})})]})},yr=function(e){var n=e.cancelledProgramTitle,r=e.to.title,t=e.onEnroll,o=(0,c.$)().t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.X6,{size:"h3",as:"h3",mb:6,children:o("settings.enrollments.cancelledEnrollmentIn",{title:n})}),(0,a.jsx)(l.xv,{children:o("settings.enrollments.enrollInNewProgram",{title:r})}),(0,a.jsx)(l.kC,{justify:"end",children:(0,a.jsx)(v.zx,{variant:"solid",onClick:t,children:o("common.enroll")})})]})};function br(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}var _r={value:"",label:""},jr=function(e){var n=e.catalogNanodegrees,r=e.checkSwitchEligibility,t=e.currentProgramTitle,i=e.currentProgramSubscriptionUrn,u=e.onBack,d=e.onSwitch,p=(0,c.$)().t,f=(0,s.useMemo)((function(){return n.map((function(e){return{value:e.key,label:e.title}}))}),[n]),m=(0,s.useState)(_r),h=m[0],g=m[1],x=(0,s.useState)(!0),y=x[0],b=x[1],_=(0,s.useState)(!1),j=_[0],C=_[1],w=function(){var e,n=(e=o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return y||b(!0),C(!0),e.next=6,r(i,n.value,p);case 6:t=e.sent,b(t.success),C(!1),g(n);case 10:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){br(a,t,o,s,i,"next",e)}function i(e){br(a,t,o,s,i,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}(),E=(0,s.useCallback)((function(){d({key:h.value,title:h.label},p)}),[h,d,p]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.X6,{size:"h3",as:"h3",textAlign:"center",mb:6,children:p("settings.enrollments.switchProgram")}),(0,a.jsxs)(l.xu,{mb:6,children:[(0,a.jsxs)(l.Kq,{spacing:4,mb:4,children:[(0,a.jsx)(l.xv,{children:p("settings.enrollments.whichProgram",{title:t})}),(0,a.jsx)(l.xv,{color:"gray.900",children:(0,a.jsxs)(ye.c,{i18nKey:"settings.enrollments.visitHelpCenter",children:["_",(0,a.jsx)(l.rU,{href:"https://udacity.zendesk.com/hc/en-us/articles/360054765992",isExternal:!0,children:"_"}),"_"]})})]}),(0,a.jsxs)(W.NI,{children:[(0,a.jsx)(W.lX,{mb:2,children:p("common.programs")}),(0,a.jsx)(B.Z,{id:"switch-program",options:f,onChange:w,value:h,chakraStyles:(0,Z.AP)(),isRequired:!0,menuPosition:"fixed"})]}),!y&&(0,a.jsx)(l.xv,{color:"feedback.negative",mt:4,children:p("settings.enrollments.switchingProgramUnavailable",{title:t})})]}),(0,a.jsxs)(l.kC,{justify:"end",gap:4,children:[(0,a.jsx)(v.zx,{variant:"ghost",onClick:u,children:p("common.back")}),(0,a.jsx)(v.zx,{variant:"solid",onClick:E,isLoading:j,isDisabled:h===_r||!y,children:p("common.switchPrograms")})]})]})},Cr=function(e){var n=e.to.title,r=(0,c.$)().t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.X6,{size:"h3",as:"h3",textAlign:"center",mb:2,children:r("settings.enrollments.transferringProgram")}),(0,a.jsx)(l.xv,{align:"center",children:r("settings.enrollments.redirectToProgram",{title:n})}),(0,a.jsx)(l.kC,{justify:"center",alignItems:"center",w:"100%",h:"6rem",children:(0,a.jsx)(u.$,{label:r("common.loading")})})]})};function wr(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function Er(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function Sr(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){Er(a,t,o,s,i,"next",e)}function i(e){Er(a,t,o,s,i,"throw",e)}s(void 0)}))}}function Or(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Ar(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){Or(e,n,r[n])}))}return e}function kr(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,o,a=[],s=!0,i=!1;try{for(r=r.call(e);!(s=(t=r.next()).done)&&(a.push(t.value),!n||a.length!==n);s=!0);}catch(c){i=!0,o=c}finally{try{s||null==r.return||r.return()}finally{if(i)throw o}}return a}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return wr(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wr(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Pr=function(e){var n=e.cancelFlowFeatures,r=e.createErrorAlert,t=e.discountEnabled,i=e.handleAlternateCancelOption,c=e.handleSelfServeCancel,l=e.handleSurveyModalClose,u=e.programTitle,d=e.onSurveyDiscount,p=e.originalPrice,f=e.periodEndDate,m=e.refundable,h=e.subscriptionUrn,v=mn(),g=(0,s.useState)(!1),x=g[0],y=g[1],_=(0,s.useState)(!1),j=_[0],C=_[1],w=(0,s.useState)([]),E=w[0],S=w[1],O=(0,s.useState)($e),k=O[0],R=O[1],I=(0,s.useState)(!1),F=I[0],N=I[1],L=(0,s.useState)(!1),U=L[0],M=L[1],z=kr((0,Gn.C)({cancelReasonKey:"",cancelReasonMessage:"",declinedOffer:0,discountedDisplayPrice:"",programToSwitch:{key:"",title:""},refundDisplayAmount:"",subtotalDisplayAmount:""}),2),H=z[0],q=z[1],$=(0,b.D)().userLocation;(0,s.useEffect)((function(){(0,vn.Z)().then((function(e){v()&&S(e)}))}),[v]);var X=function(){return 0!==H.declinedOffer},K=function(){var e=Sr(o().mark((function e(n,r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.prev=1,e.next=4,P(n,r);case 4:t=e.sent.success,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(n,r){return e.apply(this,arguments)}}(),V=function(){var e=Sr(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(ve.SELF_SERVE_DISCOUNT_ACCEPTED,H.cancelReasonMessage,H.discountedDisplayPrice,H.subtotalDisplayAmount,H.refundDisplayAmount),N(!0),e.next=4,K(h,X());case 4:n=e.sent,N(!1),n?d(ve.SELF_SERVE_DISCOUNT_APPLIED,H.cancelReasonMessage,H.discountedDisplayPrice,H.subtotalDisplayAmount,H.refundDisplayAmount):(d(ve.SELF_SERVE_DISCOUNT_APPLY_FAILED,H.cancelReasonMessage,H.discountedDisplayPrice,H.subtotalDisplayAmount,H.refundDisplayAmount),R(Be));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Sr(o().mark((function e(n,t){var a,s,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.key,s=n.title,e.next=4,D(h,a,t);case 4:(i=e.sent).success?(q((function(e){return Ar({},e,{programToSwitch:{key:a,title:s}})})),R(Ke),setTimeout((function(){window.location.href="/nanodegrees/".concat(a)}),3600)):(r(i.message),console.error(i.message));case 6:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),B=function(){var e=Sr(o().mark((function e(n){var r,t,a,s,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,t="",a="",s="",y(!0),e.prev=5,e.next=8,A(n,X());case 8:i=e.sent,r=i.is_eligible,t=i.discount_amount_display,a=i.subtotal_amount_display,s=i.refunded_amount_display,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),console.error(e.t0);case 18:return v()&&(y(!1),q((function(e){return Ar({},e,{discountedDisplayPrice:t,subtotalDisplayAmount:a,refundDisplayAmount:s})}))),e.abrupt("return",r);case 20:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(n){return e.apply(this,arguments)}}(),Q=function(){var e=Sr(o().mark((function e(){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=vr(H.cancelReasonKey,n,(null===$||void 0===$?void 0:$.countryCode)||""))!==Nn.IMMEDIATE_CANCEL){e.next=6;break}return e.next=4,Z(!1);case 4:case 13:e.next=17;break;case 6:if(r!==Nn.CHAT_FLOW){e.next=10;break}i(qe.CHAT.name),e.next=17;break;case 10:if(r!==Nn.DISCOUNT_FLOW){e.next=15;break}return e.next=13,W();case 15:return e.next=17,Z(!1);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Sr(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return e.next=3,Z(!1);case 3:return e.abrupt("return");case 4:if(n=!1,!v()){e.next=17;break}return M(!0),e.next=9,B(h);case 9:if(n=e.sent,M(!1),!(n&&H.declinedOffer<2)){e.next=15;break}d(ve.SELF_SERVE_DISCOUNT_PRESENTED,H.cancelReasonMessage,H.discountedDisplayPrice,H.subtotalDisplayAmount,H.refundDisplayAmount),R(Ge),e.next=17;break;case 15:return e.next=17,Z(!1);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Sr(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d(ve.SELF_SERVE_DISCOUNT_ABANDONED,H.cancelReasonMessage,H.discountedDisplayPrice,H.subtotalDisplayAmount,H.refundDisplayAmount),!(H.declinedOffer<1)){e.next=5;break}q((function(e){return Ar({},e,{declinedOffer:e.declinedOffer+1})}),Sr(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q();case 2:case"end":return e.stop()}}),e)})))),e.next=7;break;case 5:return e.next=7,Z(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Sr(o().mark((function e(){var n,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r.length>0&&void 0!==r[0])||r[0],C(!0),e.next=4,c(H.cancelReasonMessage,n);case 4:C(!1),i(Qe);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Sr(o().mark((function e(){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=E.find((function(e){return e.key===H.programToSwitch.key})),r=n?"https://udacity.com/course/".concat(n.slug):"https://udacity.com/courses/all",window.location.href=r;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();switch(k){case $e:return(0,a.jsx)(xr,{periodEndDate:f,handleContinueCancellation:Q,handleSwitchPrograms:function(){R(Xe)},handleCancelReasonChange:function(e,n){q((function(r){return Ar({},r,{cancelReasonKey:e,cancelReasonMessage:n})}))},cancelInFlight:j,checkOfferEligibilityInFlight:x,isLoading:U,handleModalClose:l,isRefundable:m});case Ge:return(0,a.jsx)(Bn,{subtotalDisplayAmount:H.subtotalDisplayAmount,refundedDisplayAmount:H.refundDisplayAmount,cancelReasonKey:H.cancelReasonKey,handleAbandonDiscountOffer:Y,generateCouponInFlight:F,isLoading:U,handleGenerateDiscountCoupon:V,cancelInFlight:j,originalPrice:p,declinedOffer:X()});case Xe:return(0,a.jsx)(jr,{catalogNanodegrees:E,onSwitch:G,onBack:function(){R($e)},currentProgramTitle:u,currentProgramSubscriptionUrn:h,checkSwitchEligibility:T});case Ke:return(0,a.jsx)(Cr,{to:H.programToSwitch});case Ve:return(0,a.jsx)(yr,{cancelledProgramTitle:u,to:H.programToSwitch,onEnroll:J});case Be:return(0,a.jsx)(Qn,{handleCancel:Z,handleModalClose:l,cancelInFlight:j});default:return(0,a.jsx)(Xn,{})}};function Rr(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function Dr(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){Rr(a,t,o,s,i,"next",e)}function i(e){Rr(a,t,o,s,i,"throw",e)}s(void 0)}))}}var Ir=qe.SELF_SERVE_DISCOUNT.name,Tr=function(e){var n=e.cancelEventProps,r=e.cancelFlowFeatures,t=e.createErrorAlert,i=e.handleOrderHistoryUpdate,l=e.programTitle,u=e.onClose,d=e.onSelfServeCancel,p=e.onSelfServeDiscountApplied,f=e.originalPrice,m=e.periodEndDate,h=e.refundable,v=e.isOpen,g=e.subscriptionUrn,x=(0,s.useState)(Ir),y=x[0],b=x[1],_=(0,s.useState)(Ir),j=_[0],C=_[1],w=(0,s.useRef)(!0),E=(0,c.$)().t,S=(0,s.useCallback)((function(){w.current&&(nn(n,Pe,j),w.current=!1)}),[n,j]);(0,s.useEffect)((function(){S()}),[S]);var O=function(e,r){nn(n,De,j,{label:e,extraProps:r})},A=function(){i(),nn(n,Ie,j),b(Ir),u()},k=function(){O(ve.SELF_SERVE_DISCOUNT_SEARCH_CATALOG)},P=function(){var e=Dr(o().mark((function e(r,t){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t?ve.SELF_SERVE_DISCOUNT_DISQUALIFIED:ve.SELF_SERVE,s=t?qe.SELF_SERVE_DISCOUNT.name:qe.SELF_SERVE.name,nn(n,Re,j,{label:a,extraProps:{cancel_reason:r}}),e.next=5,d(r);case 5:C(s),b(Qe);case 7:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),R=function(){var e=Dr(o().mark((function e(n,r,t,a,s){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O(n,{cancel_reason:r,discounted_amount:t,refunded_amount:a,subtotal_amount:s}),n!==ve.SELF_SERVE_DISCOUNT_APPLIED){e.next=5;break}return e.next=4,p();case 4:u();case 5:case"end":return e.stop()}}),e)})));return function(n,r,t,o,a){return e.apply(this,arguments)}}(),D=function(e){Object.values(qe).map((function(e){return e.name})).includes(e)&&C(e),b(e)};return(0,a.jsx)(ee.u,{isOpen:v,onClose:A,ariaLabel:E("settings.enrollments.cancelSubscription"),title:E("settings.enrollments.cancelSubscription"),headerHidden:!0,children:function(){switch(y){case qe.SELF_SERVE_DISCOUNT.name:return(0,a.jsx)(Pr,{discountEnabled:r.self_serve_with_discount,onSurveyDiscount:R,handleSurveyModalClose:A,handleSelfServeCancel:P,handleAlternateCancelOption:D,periodEndDate:m,refundable:h,subscriptionUrn:g,originalPrice:f,programTitle:l,createErrorAlert:t,cancelFlowFeatures:r});case Qe:return(0,a.jsx)(Vn,{periodEndDate:m,handleModalClose:A,isRefundable:h,handleCatalogOpen:k});case qe.CHAT.name:console.error('"'.concat(qe.CHAT.name,'" selected in cancel flow')),b(Ir);default:return(0,a.jsx)(Xn,{})}}()})},Fr=r(25486),Nr=r(57557),Lr=r.n(Nr),Ur=r(8238),Mr=r(56221),zr=function(e){var n=e.isOpen,r=e.onCloseModal,t=e.onConfirmAutoPay,o=(0,c.$)().t;return(0,a.jsxs)(Mr.u_,{isCentered:!0,isOpen:n,onClose:r,children:[(0,a.jsx)(Mr.ZA,{}),(0,a.jsxs)(Mr.hz,{maxW:"50rem",p:8,children:[(0,a.jsx)(Mr.xB,{children:(0,a.jsx)(l.X6,{textAlign:"center",size:"h2",children:o("settings.enrollments.enableAutoRenewNeverMiss")})}),(0,a.jsx)(Mr.ol,{}),(0,a.jsx)(Mr.fe,{p:8,children:(0,a.jsx)(l.xv,{color:"gray.900",align:"center",children:o("settings.enrollments.enableAutoRenewDescription")})}),(0,a.jsxs)(Mr.mz,{justifyContent:"center",gap:4,children:[(0,a.jsx)(v.zx,{variant:"solid",onClick:t,autoFocus:!0,children:o("settings.enrollments.enableAutoRenew")}),(0,a.jsx)(v.zx,{variant:"outline",onClick:r,children:o("common.cancel")})]})]})]})};function Hr(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}var qr=function(e){var n=e.autoRenewConfigurable,r=e.autoRenewEligible,t=e.autoRenewOn,i=e.processor,u=e.onAutoRenewChange,d=e.subscription,p=(0,s.useState)(!1),f=p[0],m=p[1],h=(0,c.$)().t,v=Lr()(d,"next_payment","payment_method","payment_history"),g=function(){var e,n=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u(d.urn,!0);case 3:(0,fe.j)("Clicked Enable Auto-Renew for Subscription",{subscription:v}),m(!1),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),m(!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){Hr(a,t,o,s,i,"next",e)}function i(e){Hr(a,t,o,s,i,"throw",e)}s(void 0)}))});return function(){return n.apply(this,arguments)}}();return n?n&&t?(0,a.jsx)(l.xv,{children:h("settings.enrollments.autoRenewEnabled")}):r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.kC,{alignItems:"center",children:[(0,a.jsx)(zr,{onConfirmAutoPay:g,onCloseModal:function(){(0,fe.j)("Closed Subscription Enable Auto-Renew Modal",{subscription:v}),m(!1)},isOpen:f}),(0,a.jsx)(W.NI,{children:(0,a.jsxs)(l.Kq,{align:"center",direction:"row",spacing:4,children:[(0,a.jsx)(Ur.r,{id:"autopay-".concat(d.urn),isChecked:t,onChange:function(){(0,fe.j)("Opened Subscription Enable Auto-Renew Modal",{subscription:v}),m(!0)},name:"autopay-checkbox"}),(0,a.jsx)(W.lX,{htmlFor:"autopay-".concat(d.urn),children:h("settings.enrollments.enableAutoRenewLabel")})]})})]}),n&&"stripe"===i&&(0,a.jsx)($n.b,{status:"warning",children:h("settings.enrollments.addPayment")}),(0,a.jsx)(l.xv,{children:h("settings.enrollments.keepSubscriptionActiveAndEnabledAutoRenew")})]}):(0,a.jsx)(l.xv,{children:h("settings.enrollments.keepSubscriptionActive")}):null},$r=function(e){var n=e.date,r=e.type,t=(0,de.aT)(n),o=new Map;o.set("overdue",{key:"settings.enrollments.paymentPastDue",status:"warning"}),o.set("failed",{key:"settings.enrollments.paymentFailed",status:"error"}),o.set("preorder",{key:"settings.enrollments.payBeforeDate",status:"warning"});var s=o.get(r);return(0,a.jsx)($n.b,{status:s.status,children:(0,a.jsx)(l.xv,{children:(0,a.jsxs)(ye.c,{i18nKey:s.key,values:{date:t},children:[(0,a.jsx)("strong",{children:"_"}),"_",(0,a.jsx)("strong",{children:"_"}),"_"]})})})};function Xr(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}var Kr=function(e){var n,r,t,s,i,u,d=e.programTitle,p=e.enrollmentDate,f=e.isPaymentOverdue,m=e.isPreorder,h=e.statusLabel,g=e.lastPayment,x=e.nextPayment,y=e.shouldRenderPaymentMethod,_=e.subscription,j=e.predictions,C=e.cancelFlowFeatures,w=e.canGraduate,E=e.createErrorAlert,S=e.onDiscountApplied,O=e.onOrderCancel,A=e.refreshOrderHistory,k=e.autoRenewConfigurable,P=e.autoRenewEligible,R=e.onAutoRenewChange,D=(0,c.$)().t,I=(0,je.qY)(),T=I.isOpen,F=I.onOpen,N=I.onClose,L=(0,b.D)().userLocation,U=_.status,M=_.type,z=_.cancel_url,H=_.can_refund,q=_.original_price,$=_.payment_method,X=_.period_end_date,K=_.urn,V=fn(j,null),G=on(null===L||void 0===L?void 0:L.countryCode,null===L||void 0===L?void 0:L.region,_,V,C),B=function(){var e,n=(e=o().mark((function e(n,r){var t,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.can_refund,a=_.type,s=_.urn,e.next=3,O(s,a,t,!1,n,r);case 3:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){Xr(a,t,o,s,i,"next",e)}function i(e){Xr(a,t,o,s,i,"throw",e)}s(void 0)}))});return function(e,r){return n.apply(this,arguments)}}(),Q=(0,Fr.q)(_),W=(null===$||void 0===$||null===(n=$.processor_data)||void 0===n||null===(r=n.card)||void 0===r?void 0:r.brand)?"".concat($.processor_data.card.brand," \u2022\u2022\u2022\u2022 ").concat($.processor_data.card.last4):"".concat($.description);return(0,a.jsxs)(l.kC,{direction:"column",gap:4,p:6,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.X6,{size:"h2",mb:1,children:d}),(0,a.jsx)(zn.Vp,{children:h})]}),(0,pn.Mr)(g)&&(0,a.jsx)($r,{date:null!==(s=null===(t=g.charge)||void 0===t?void 0:t.charged_at)&&void 0!==s?s:"",type:"failed"}),f?m?(0,a.jsx)($r,{date:x.due_at,type:"preorder"}):(0,a.jsx)($r,{date:x.due_at,type:"overdue"}):null,Q&&(0,a.jsx)($n.b,{status:"info",children:(0,a.jsx)(l.xv,{children:(0,a.jsxs)(ye.c,{i18nKey:"settings.enrollments.trialLimit",values:{count:Fr.m},children:["_",(0,a.jsx)("strong",{children:"_"}),"_"]})})}),(0,a.jsxs)(l.MI,{columns:2,spacingY:4,spacingX:4,w:"full",children:[(0,a.jsx)(Hn,{label:p.label,date:p.date}),(0,a.jsx)(Hn,{label:D("settings.enrollments.paymentDue"),date:x.due_at}),y&&(0,a.jsxs)(l.Kq,{spacing:0,children:[(0,a.jsx)(l.xv,{size:"label",color:"gray.900",children:D("settings.enrollments.paymentMethodCapitalized")}),(0,a.jsx)(l.X6,{size:"h3",as:"h3",children:W})]}),(0,a.jsxs)(l.Kq,{spacing:0,children:[(0,a.jsx)(l.xv,{size:"label",color:"gray.900",children:D("settings.enrollments.paymentAmount")}),(0,a.jsx)(l.X6,{size:"h3",as:"h3",children:(0,pn.kb)(x)})]})]}),(0,a.jsx)(qr,{autoRenewConfigurable:k,autoRenewEligible:P,autoRenewOn:null!==(i=x.can_auto_renew)&&void 0!==i&&i,processor:null!==(u=null===$||void 0===$?void 0:$.processor)&&void 0!==u?u:"",onAutoRenewChange:R,subscription:_}),(0,a.jsxs)(l.kC,{gap:6,children:[(null===x||void 0===x?void 0:x.payment_url)&&(0,a.jsx)(v.zx,{as:l.rU,href:x.payment_url,textDecor:"none",isExternal:!0,w:"max-content","aria-label":"".concat(D("common.payNow")," ").concat(d),_visited:{color:"white"},_hover:{textDecor:"none",color:"white"},children:D("common.payNow")}),z&&hn.Bc.includes(U)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.zx,{onClick:F,variant:"ghost","aria-label":"".concat(D("common.cancel")," ").concat(d),children:D("common.cancel")}),(0,a.jsx)(Tr,{isOpen:T,programTitle:d,onClose:N,onSelfServeCancel:B,onSelfServeDiscountApplied:S,handleOrderHistoryUpdate:A,itemType:M,cancelEventProps:G,cancelFlowFeatures:C,refundable:H&&!w,isPreorder:U===hn.Q_.PREORDER,periodEndDate:(0,de.p6)(X),subscriptionUrn:K,originalPrice:q,createErrorAlert:E},"cancel")]})]})]})};function Vr(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}var Gr=function(e){var n,r,t=e.programTitle,s=e.enrollmentDate,i=e.lastPayment,u=e.statusLabel,d=e.subscription,p=e.predictions,f=e.cancelFlowFeatures,m=e.canGraduate,h=e.createErrorAlert,g=e.onDiscountApplied,x=e.onOrderCancel,y=e.refreshOrderHistory,_=(0,c.$)().t,j=(0,je.qY)(),C=j.isOpen,w=j.onOpen,E=j.onClose,S=(0,b.D)().userLocation,O=d.status,A=d.type,k=d.cancel_url,P=d.can_refund,R=d.original_price,D=d.period_end_date,I=d.urn,T=fn(p,null),F=on(null===S||void 0===S?void 0:S.countryCode,null===S||void 0===S?void 0:S.region,d,T,f),N=function(){var e,n=(e=o().mark((function e(n,r){var t,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.can_refund,a=d.type,s=d.urn,e.next=3,x(s,a,t,!1,n,r);case 3:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){Vr(a,t,o,s,i,"next",e)}function i(e){Vr(a,t,o,s,i,"throw",e)}s(void 0)}))});return function(e,r){return n.apply(this,arguments)}}(),L=(0,Fr.q)(d),U=(0,pn.Mr)(i);return(0,a.jsxs)(l.kC,{direction:"column",gap:4,p:6,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.X6,{size:"h2",mb:1,children:t}),(0,a.jsx)(zn.Vp,{children:u})]}),U&&(0,a.jsx)($r,{date:null!==(r=null===(n=i.charge)||void 0===n?void 0:n.charged_at)&&void 0!==r?r:"",type:"failed"}),L&&(0,a.jsx)($n.b,{status:"info",children:(0,a.jsx)(l.xv,{children:(0,a.jsxs)(ye.c,{i18nKey:"settings.enrollments.trialLimit",values:{count:Fr.m},children:["_",(0,a.jsx)("strong",{children:"_"}),"_"]})})}),(0,a.jsx)(Hn,{label:s.label,date:s.date}),!U&&(0,a.jsx)(l.xv,{children:_("settings.enrollments.noUpcomingPayment")}),k&&hn.Bc.includes(O)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.zx,{onClick:w,w:"max-content",variant:"outline","aria-label":"".concat(_("common.cancel")," ").concat(t),children:_("common.cancel")}),(0,a.jsx)(Tr,{isOpen:C,programTitle:t,onClose:E,onSelfServeCancel:N,onSelfServeDiscountApplied:g,handleOrderHistoryUpdate:y,itemType:A,cancelEventProps:F,cancelFlowFeatures:f,refundable:P&&!m,isPreorder:O===hn.Q_.PREORDER,periodEndDate:(0,de.p6)(D),subscriptionUrn:I,originalPrice:R,createErrorAlert:h},"cancel")]})]})},Br=function(e){var n=e.programTitle,r=e.enrollmentDate,t=e.catalogSlug,o=e.status,s=(0,c.$)().t;return(0,a.jsxs)(l.kC,{direction:"column",gap:4,p:6,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.X6,{size:"h2",mb:1,children:n}),(0,a.jsx)(zn.Vp,{children:o})]}),(0,a.jsx)(Hn,{label:r.label,date:r.date}),(0,a.jsx)(l.xv,{children:s("settings.enrollments.jumpBackIn")}),(0,a.jsx)(v.zx,{as:l.rU,href:"https://www.udacity.com/course/".concat(t),w:"max-content",textDecor:"none",isExternal:!0,_visited:{color:"white"},_hover:{textDecor:"none",color:"white"},children:s("settings.enrollments.reenroll")})]})},Qr=function(e){var n=e.programTitle,r=e.enrollmentDate,t=e.status,o=e.onUncancel,s=(0,c.$)().t;return(0,a.jsxs)(l.kC,{direction:"column",gap:4,p:6,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.X6,{size:"h2",mb:1,children:n}),(0,a.jsx)(zn.Vp,{children:t})]}),(0,a.jsx)(Hn,{label:r.label,date:r.date}),(0,a.jsx)(l.xv,{children:s("settings.enrollments.notTooLate")}),(0,a.jsx)(v.zx,{onClick:o,w:"max-content",children:s("settings.enrollments.keepEnrollment")})]})};function Wr(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function Yr(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function Zr(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Jr(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,o,a=[],s=!0,i=!1;try{for(r=r.call(e);!(s=(t=r.next()).done)&&(a.push(t.value),!n||a.length!==n);s=!0);}catch(c){i=!0,o=c}finally{try{s||null==r.return||r.return()}finally{if(i)throw o}}return a}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return Wr(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wr(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var et=function(e){var n,r=e.canGraduate,t=e.createErrorAlert,i=e.handleOrderHistoryUpdate,u=e.onAutoRenewChange,d=e.onDiscountApplied,p=e.onOrderCancel,f=e.onOrderUncancel,m=e.autoRenewConfigurable,h=e.autoRenewEligible,v=e.subscription,g=(0,c.$)().t,x=mn(),y=(0,s.useState)(null),j=y[0],w=y[1],E=(0,s.useState)(null),S=E[0],O=E[1],A=(0,s.useState)(rn(null)),k=A[0],P=A[1],R=(0,b.D)().userLocation,D=(0,s.useCallback)((n=o().mark((function e(){var n,r,t,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=v.purchased_products,e.prev=1,!x()){e.next=10;break}return e.next=5,(0,vn.S)(n[0].nanodegree_key);case 5:r=e.sent,t=r?r.items:[],s=null!==(a=t[0])&&void 0!==a?a:null,x()&&O(s);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})),function(){var e=this,r=arguments;return new Promise((function(t,o){var a=n.apply(e,r);function s(e){Yr(a,t,o,s,i,"next",e)}function i(e){Yr(a,t,o,s,i,"throw",e)}s(void 0)}))}),[x,v]);(0,s.useEffect)((function(){D()}),[D]);var I,T,F=Ue,N=Me,L=ze,U=He,M=fn(j,1),z=(Zr(I={},F,null===R||void 0===R?void 0:R.countryCode),Zr(I,N,null===R||void 0===R?void 0:R.region),Zr(I,U,cn.Z.get((0,C.H)("optly_udacity_test"))),Zr(I,L,M.score),I),H=v.cancel_url,q=v.status,$=null!==(T=Object.keys(hn.Q_).find((function(e){return hn.Q_[e]===q})))&&void 0!==T?T:"",X=(0,dn.mk)(H&&hn.Bc.includes(hn.Q_[$])&&R?{keys:Object.values(Le),attributes:z}:un.skipToken),K=X.data,V=X.error,G=(0,s.useCallback)((function(){if(K){var e=Object.entries(Le).reduce((function(e,n){var r=Jr(n,2),t=r[0],o=r[1];return K&&(e[t]=!!K[o]),e}),{});x()&&P(e)}}),[K,x]);(0,s.useEffect)((function(){V&&(console.error(V),P(rn(null)))}),[V]);var B=(0,dn.Hn)(),Q=B.data,W=B.error,Y=(0,s.useCallback)((function(){Q&&x()&&w(Q)}),[Q,x]);(0,s.useEffect)((function(){W&&console.error(W)}),[W]),(0,s.useEffect)((function(){Y(),G()}),[G,Y]);var Z,J,ee=(0,s.useMemo)((function(){var e,n=v.created_at,r=v.canceled_at,t=v.next_payment,o=v.period_end_date,a=v.status,s=v.updated_at;return a===hn.Q_.PREORDER?{label:g("settings.enrollments.opensOn"),date:null!==(e=null===t||void 0===t?void 0:t.due_at)&&void 0!==e?e:""}:hn.Bc.includes(a)?{label:g("settings.enrollments.enrolledOn"),date:n}:a===hn.Q_.CANCELING?{label:g("settings.enrollments.enrollmentsEndOn"),date:o}:{label:g("settings.enrollments.unenrolledOn"),date:r||s}}),[g,v]),ne=v.next_payment,re=v.payment_method,te=v.purchased_products,oe=v.purchased_product_description,ae=v.payment_history,se=v.payment_plan,ie=v.type,ce=v.can_uncancel,le=v.urn,ue=v.no_uncancel_reason,de=v.period_end_date,pe=re&&hn.UZ.includes(q),fe=ne||!(0,_.isEmpty)(ae),me=(0,s.useMemo)((function(){return Object.values(hn.Q_).includes(q)?(0,hn.uP)(q,g):null}),[g,q]);return(0,a.jsxs)(l.xu,{rounded:"base",border:"1px",borderColor:"gray.300",bgColor:"white",children:[ne&&(0,a.jsx)(Kr,{programTitle:oe,enrollmentDate:ee,isPaymentOverdue:(0,pn.HJ)(ne),isPreorder:(0,pn.zR)(v),statusLabel:me,lastPayment:null!==(Z=ae[0])&&void 0!==Z?Z:{},nextPayment:ne,shouldRenderPaymentMethod:pe,subscription:v,predictions:j,cancelFlowFeatures:k,canGraduate:r,createErrorAlert:t,onDiscountApplied:d,onOrderCancel:p,refreshOrderHistory:i,autoRenewConfigurable:m,autoRenewEligible:h,onAutoRenewChange:u}),ie===an.FLEX_SUBSCRIPTION&&(q===hn.Q_.CANCELING&&ce?(0,a.jsx)(Qr,{programTitle:oe,enrollmentDate:ee,status:me,onUncancel:function(){return f(le)}}):q!==hn.Q_.CANCELING||ce?!ne&&S&&(0,a.jsx)(Br,{programTitle:oe,enrollmentDate:ee,catalogSlug:S.slug,status:me}):(0,a.jsx)(qn,{programTitle:oe,enrollmentDate:ee,noUncancelReason:ue,periodEndDate:de,status:me})),!(ie===an.FLEX_SUBSCRIPTION)&&!ne&&(0,a.jsx)(Gr,{programTitle:oe,enrollmentDate:ee,lastPayment:null!==(J=ae[0])&&void 0!==J?J:{},statusLabel:me,subscription:v,predictions:j,cancelFlowFeatures:k,canGraduate:r,createErrorAlert:t,onDiscountApplied:d,onOrderCancel:p,refreshOrderHistory:i}),fe&&(0,a.jsx)(ln.UQ,{allowToggle:!0,children:(0,a.jsxs)(ln.Qd,{_last:{borderBottom:"none",borderBottomRadius:"base"},children:[(0,a.jsx)("h4",{children:(0,a.jsxs)(ln.KF,{border:"none",borderTop:"1px solid",borderTopColor:"gray.300",children:[(0,a.jsx)(l.xu,{flex:1,textAlign:"start",as:"span",children:g("settings.enrollments.billingHistory")}),(0,a.jsx)(ln.XE,{ms:4})]})}),(0,a.jsx)(ln.Hk,{p:0,border:"none",children:(0,a.jsx)(Ln,{createErrorAlert:t,nextPayment:ne,payments:ae,productInfo:te[0],paymentPlan:se,isFlexSubscription:ie===an.FLEX_SUBSCRIPTION})})]})})]},v.urn)};function nt(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function rt(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var tt=function(e){var n=e.subscriptions,r=e.isReadyToGraduateNdKeys,t=rt(e,["subscriptions","isReadyToGraduateNdKeys"]);return(0,a.jsx)(l.Kq,{spacing:4,children:n.map((function(e){var n,o,s,i,c=null===e||void 0===e||null===(n=e.purchased_products)||void 0===n||null===(o=n[0])||void 0===o?void 0:o.nanodegree_key,l=void 0!==c&&r.includes(c),u=null!==(i=null===e||void 0===e||null===(s=e.payment_method)||void 0===s?void 0:s.supports_auto_renew)&&void 0!==i&&i;return(0,a.jsx)(et,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){nt(e,n,r[n])}))}return e}({subscription:e,canGraduate:l,autoRenewConfigurable:u},t),e.urn)}))})};function ot(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function at(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function st(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){at(a,t,o,s,i,"next",e)}function i(e){at(a,t,o,s,i,"throw",e)}s(void 0)}))}}function it(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function ct(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){it(e,n,r[n])}))}return e}function lt(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,o,a=[],s=!0,i=!1;try{for(r=r.call(e);!(s=(t=r.next()).done)&&(a.push(t.value),!n||a.length!==n);s=!0);}catch(c){i=!0,o=c}finally{try{s||null==r.return||r.return()}finally{if(i)throw o}}return a}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return ot(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ot(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ut=function(e){var n=e.cancelOrder,r=e.cancelTermPurchase,t=e.refreshOrderHistory,i=e.isAutoRenewEligible,u=e.isReadyToGraduateNdKeys,d=e.orderHistory,p=e.uncancelOrder,f=e.updateAutoRenew,m=e.userId,h=e.createErrorAlert,g=e.createNotificationAlert,x=(0,c.$)().t,y=lt((0,Ce.zq)(),1)[0],b=(0,je.qY)(),_=b.isOpen,j=b.getButtonProps,C=b.getDisclosureProps,w=(0,s.useCallback)(function(){var e=st(o().mark((function e(n,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(n,r);case 3:a=x(r?"settings.enrollments.autoRenewOnSaved":"settings.enrollments.autoRenewOffSaved"),g(a),t(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),h(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,r){return e.apply(this,arguments)}}(),[h,g,t,x,f]),E=(0,s.useCallback)(function(){var e=st(o().mark((function e(t,a,s,i,c,l){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a!==an.FLEX_SUBSCRIPTION){e.next=13;break}return e.next=4,n(t,s,i,c,l);case 4:if(!i){e.next=10;break}return e.next=7,y({userKey:m,changes:[{category:"cancellation",channel:"phone",value:!1},{category:"cancellation",channel:"email",value:!0}]});case 7:g(x("settings.enrollments.cancellationReceived")),e.next=11;break;case 10:g(x("settings.enrollments.cancellationProcessed"));case 11:e.next=16;break;case 13:return e.next=15,r(t);case 15:g(x("settings.enrollments.cancellationPending"));case 16:s&&!i&&g(x("settings.enrollments.refundProcessed")),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(0),h(x("settings.enrollments.errorCanceling")),console.error(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(n,r,t,o,a,s){return e.apply(this,arguments)}}(),[n,r,h,g,x,y,m]),S=(0,s.useCallback)(function(){var e=st(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p(n);case 3:g(x("settings.enrollments.cancellationRequestClosed")),t(),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),r=x("settings.enrollments.errorReenrolling"),h(r);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}(),[h,g,t,x,p]),O=(0,s.useCallback)((function(){g(x("settings.enrollments.discountApplied")),t()}),[g,t,x]),A=(0,s.useMemo)((function(){return e=d,ke()(e,(function(e){var n=e.next_payment;return n?new Date(n.due_at):new Date(Ee()(e,"payment_history[0].charge.charged_at",e.created_at))})).reverse();var e}),[d]),k=A.length,P=A.slice(0,2),R=A.filter((function(e){return!P.find((function(n){return n.urn===e.urn}))}));return(0,a.jsxs)(l.Kq,{spacing:4,children:[k>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tt,{subscriptions:P,isReadyToGraduateNdKeys:null!==u&&void 0!==u?u:[],autoRenewEligible:i,onAutoRenewChange:w,onOrderCancel:E,onOrderUncancel:S,onDiscountApplied:O,handleOrderHistoryUpdate:t,createErrorAlert:h}),(0,a.jsx)(l.xu,ct({},C(),{children:(0,a.jsx)(tt,{subscriptions:R,isReadyToGraduateNdKeys:null!==u&&void 0!==u?u:[],autoRenewEligible:i,onAutoRenewChange:w,onOrderCancel:E,onOrderUncancel:S,onDiscountApplied:O,handleOrderHistoryUpdate:t,createErrorAlert:h})}))]}):(0,a.jsx)(sn,{}),k>2&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(l.kC,{justify:"center",children:(0,a.jsx)(v.zx,ct({variant:"ghost"},j(),{onMouseDown:function(e){return e.preventDefault()},children:_?x("common.seeLess"):x("common.seeXMore",{number:k-2})}))})})]})},dt=r(69549),pt=r(84513),ft=r(52353),mt=r.n(ft);function ht(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function vt(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){ht(a,t,o,s,i,"next",e)}function i(e){ht(a,t,o,s,i,"throw",e)}s(void 0)}))}}function gt(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function xt(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){gt(e,n,r[n])}))}return e}var yt=function(){var e=vt(o().mark((function e(n,r,t,a,s){var i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat((0,C.H)("/api/braavos"),"/subscriptions/").concat(n,"/cancel"),c=xt({refund_expected:r,cancel_reason:a,intercom_cancel:t},s),e.next=4,(0,w.v_)(i,Lr()(c,Object.keys(c).filter((function(e){return mt()(c[e])}))));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(n,r,t,o,a){return e.apply(this,arguments)}}(),bt=function(){var e=vt(o().mark((function e(n){var r,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat((0,C.H)("/api/braavos"),"/purchases/").concat(n,"/cancel"),e.next=3,(0,w.v_)(r,{});case 3:return t=e.sent.data,e.abrupt("return",{urn:n,status:t.purchase.status});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_t=function(){var e=vt(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat((0,C.H)("/api/braavos"),"/subscriptions/").concat(n,"/uncancel"),e.next=3,(0,w.v_)(r,{});case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),jt=function(){var e=vt(o().mark((function e(n,r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat((0,C.H)("/api/braavos"),"/subscriptions/").concat(n,"/update_auto_renew"),e.next=3,(0,w.gz)(t,{auto_renew:r});case 3:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),Ct=r(34888),wt=r(10037);function Et(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function St(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function Ot(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,o,a=[],s=!0,i=!1;try{for(r=r.call(e);!(s=(t=r.next()).done)&&(a.push(t.value),!n||a.length!==n);s=!0);}catch(c){i=!0,o=c}finally{try{s||null==r.return||r.return()}finally{if(i)throw o}}return a}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return Et(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Et(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var At=function(){var e,n,r=(0,x.V)(),t=(0,dt.B)().enrollments,m=(0,c.$)().t,h=(0,pt.a)().user,v=(0,y.I)(),g=v.data,b=v.isFetching,_=v.refetch,j=Ot((0,d.u6)(),1)[0],C=(0,s.useMemo)((function(){return t.filter((function(e){return e.program.kind===Ct.B.FREE_COURSE}))}),[t]),w=(0,s.useCallback)(function(){var e,n=(e=o().mark((function e(n){var t,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return console.error("Cannot cancel course with missing course key"),e.abrupt("return");case 3:return e.prev=3,e.next=6,j(n);case 6:t="Remove Course Submitted",a=C.find((function(e){return e.program.key===n})),s=a?{course_id:a.program.id,category:t,label:t,is_graduated:a.isGraduated,title:a.program.title}:{},(0,fe.j)(t,s),r({variant:"success",message:m("settings.enrollments.successfullyRemoved")}),e.next=18;break;case 13:throw e.prev=13,e.t0=e.catch(3),console.error(e.t0),r({variant:"error",message:m("settings.enrollments.errorRemoving")}),e.t0;case 18:case"end":return e.stop()}}),e,null,[[3,13]])})),function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){St(a,t,o,s,i,"next",e)}function i(e){St(a,t,o,s,i,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}(),[r,j,C,m]);(0,s.useEffect)((function(){(0,fe.Md)("Enrollments")}),[]);var E,S,O=t.filter((function(e){return e.isReadyForGraduation})).map((function(e){return e.program.key})).filter(wt.$).filter(wt.K),A=!!(null===g||void 0===g?void 0:g.billingInfo.canAddCreditCard),k=Number(null===g||void 0===g||null===(e=g.billingInfo)||void 0===e||null===(n=e.billingMethods)||void 0===n?void 0:n.length)>0,P=A||k;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.PB,{title:m("settings.enrollments.enrollmentSettings")}),(0,a.jsx)(p.X,{children:(0,a.jsx)(f.dU,{children:b?(0,a.jsx)(l.kC,{alignItems:"center",justifyContent:"center",h:"full",children:(0,a.jsx)(u.$,{pt:4,label:m("common.loading")})}):(0,a.jsxs)(l.Kq,{spacing:12,children:[(0,a.jsxs)("section",{children:[(0,a.jsx)(l.X6,{size:"h2",mb:4,children:m("settings.enrollments.paidEnrollments")}),(0,a.jsx)(ut,{cancelOrder:yt,isAutoRenewEligible:!!(null===g||void 0===g?void 0:g.billingInfo.autoRenewEligible),cancelTermPurchase:bt,refreshOrderHistory:_,isReadyToGraduateNdKeys:O,orderHistory:null!==(E=null===g||void 0===g?void 0:g.orderHistory)&&void 0!==E?E:[],uncancelOrder:_t,updateAutoRenew:jt,userId:null!==(S=null===h||void 0===h?void 0:h.id)&&void 0!==S?S:"",createErrorAlert:function(e){return r({message:e,variant:"error"})},createNotificationAlert:function(e){return r({message:e})}})]}),P&&(0,a.jsxs)("section",{children:[(0,a.jsx)(l.X6,{size:"h2",mb:4,children:m("settings.enrollments.paymentMethodCapitalized")}),(0,a.jsx)(ue,{isCardAddEnabled:A})]}),(0,a.jsx)(f.we,{title:m("settings.enrollments.freeEnrollments"),children:(0,a.jsx)(xe,{enrollments:C,cancelEnrollment:w})}),(0,a.jsx)(_e,{})]})})})]})}},15199:function(e,n,r){"use strict";r.d(n,{Z:function(){return l},S:function(){return d}});var t=r(34051),o=r.n(t),a=r(51179),s=r(63686);function i(e,n,r,t,o,a,s){try{var i=e[a](s),c=i.value}catch(l){return void r(l)}i.done?n(c):Promise.resolve(c).then(t,o)}function c(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function s(e){i(a,t,o,s,c,"next",e)}function c(e){i(a,t,o,s,c,"throw",e)}s(void 0)}))}}function l(){return u.apply(this,arguments)}function u(){return(u=c(o().mark((function e(){var n,r,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,(0,s.U2)("https://www.udacity.com/www-proxy/contentful/spaces/2y9b3o528xhq/environments/master/entries?include=1&content_type=pageNdopV0&select=fields.title,fields.key,fields.slug&limit=500&fields.isDisplayedPublicly=true",{Authorization:"Bearer ".concat((0,a.H)("ct2yAhK-WnLIX6okaqx_6KCs-xd1sAR3yt1xRxMHQ0w"))},{});case 4:return t=e.sent,e.abrupt("return",(null===(n=t.data)||void 0===n||null===(r=n.items)||void 0===r?void 0:r.map((function(e){return null===e||void 0===e?void 0:e.fields})))||[]);case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=c(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.Ps)("https://graphql.contentful.com/content/v1/spaces/2y9b3o528xhq/environments/master",'query LearnWeb_getProgramFromContentful {\n        pageNdopV0Collection(where: { key_in: ["'.concat(n,'"] }){\n          items {\n            key\n            slug\n          }\n        }\n      }'),{},{Authorization:"Bearer ".concat((0,a.H)("ct2yAhK-WnLIX6okaqx_6KCs-xd1sAR3yt1xRxMHQ0w"))});case 3:return r=e.sent,e.abrupt("return",r.data.pageNdopV0Collection);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}}},function(e){e.O(0,[2678,3817,6940,2579,3685,2962,2012,9302,2610,1222,7536,6854,4098,3271,8826,1325,9774,2888,179],(function(){return n=53239,e(e.s=n);var n}));var n=e.O();_N_E=n}]);